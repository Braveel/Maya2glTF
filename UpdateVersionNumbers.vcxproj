<?xml version="1.0" encoding="utf-8"?>
<Project DefaultTargets="Version" ToolsVersion="15.0" xmlns="http://schemas.microsoft.com/developer/msbuild/2003">
  <PropertyGroup Label="Globals">
    <ProjectGuid>{DB71196F-C8B0-4320-97E5-186A2DD21F1B}</ProjectGuid>
    <WindowsTargetPlatformVersion>8.1</WindowsTargetPlatformVersion>
    <ProjectName>maya2glTF_revision</ProjectName>
  </PropertyGroup>
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.Default.props" />
  <Import Project="$(VCTargetsPath)\Microsoft.Cpp.props" />
  <ImportGroup Label="ExtensionTargets">
    <Import Project="packages\MSBuildTasks.1.5.0.235\build\MSBuildTasks.targets" Condition="Exists('packages\MSBuildTasks.1.5.0.235\build\MSBuildTasks.targets')" />
  </ImportGroup>
  <Target Name="EnsureNuGetPackageBuildImports" BeforeTargets="PrepareForBuild">
    <PropertyGroup>
      <ErrorText>This project references NuGet package(s) that are missing on this computer. Use NuGet Package Restore to download them.  For more information, see http://go.microsoft.com/fwlink/?LinkID=322105. The missing file is {0}.</ErrorText>
    </PropertyGroup>
    <Error Condition="!Exists('packages\MSBuildTasks.1.5.0.235\build\MSBuildTasks.targets')" Text="$([System.String]::Format('$(ErrorText)', 'packages\MSBuildTasks.1.5.0.235\build\MSBuildTasks.targets'))" />
  </Target>
  <Target Name="Version" BeforeTargets="PrepareForBuild">
    <GitDescribe LightWeight="True" LocalPath="$(MSBuildProjectDirectory)">
      <Output TaskParameter="Tag" PropertyName="GIT_Tag" />
    </GitDescribe>
    <GitVersion LocalPath="$(MSBuildProjectDirectory)">
      <Output TaskParameter="CommitHash" PropertyName="GIT_Hash" />
    </GitVersion>
    <FileUpdate Files="$(ProjectDir)\src\version.cpp" Multiline="true" Singleline="false" Regex="version\s*\=\s*&quot;(.+)&quot;" ReplacementText="version = &quot;$(GIT_Tag) $(GIT_Hash)&quot;" />
    <FileUpdate Files="$(ProjectDir)\maya\scripts\maya2glTF_UI.mel" Multiline="true" Singleline="false" Regex="\$maya2glTF_version\s*\=\s*&quot;(.+)&quot;" ReplacementText="$maya2glTF_version = &quot;$(GIT_Tag) $(GIT_Hash)&quot;" Encoding="utf-8-without-bom" />
    <FileUpdate Files="$(ProjectDir)\windows_build_release.bat" Multiline="true" Singleline="false" Regex="_.+\.zip" ReplacementText="_$(GIT_Tag).zip" />
    <FileUpdate Files="$(ProjectDir)\readme.md" Multiline="true" Singleline="false" Regex=".+\sis\sreleased\!" ReplacementText="$(GIT_Tag) is released!" />
  </Target>
</Project>